(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{140:function(e,t,n){},141:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(107),i=n.n(a),s=(n(140),n(7)),o=n(29),l=n(112),j=n(243),u=n(231),d=n(244),b=(n(141),n(245)),O=n(178),x=n(15),h=n(18),f=n(34),p=n.n(f),m=n(28),v=n(17),g=m.c[Object(v.g)()],y=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(g.apiUrl,"/info?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(h.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,e.next=4,p.a.post("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId),n);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,e.next=4,p.a.put("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId),n);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(g.apiUrl,"/instructor/balances?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(g.apiUrl,"/instructor/requests?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(h.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("UPDATING request"),e.prev=1,n=t,e.next=5,p.a.put("".concat(g.apiUrl,"/instructor/requests?PHPSESSID=").concat(g.sessionId),n);case 5:return e.abrupt("return");case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(g.apiUrl,"/learner/settings?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.get("".concat(g.apiUrl,"/learner/requests?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(h.a)(Object(x.a)().mark((function e(t,n){var c;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={category_id:t,learner_comment:n},e.next=4,p.a.post("".concat(g.apiUrl,"/learner/requests?PHPSESSID=").concat(g.sessionId),c);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),T=n(0);var q=function(e){var t=Object(c.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(),o=Object(s.a)(i,2),l=o[0],j=o[1];return Object(c.useEffect)((function(){y().then((function(e){!e||"string"===typeof e&&e.includes("Session expired")?(console.error("SESSION EXPIRED"),a(!0)):(j(e),a(!1))}))}),[]),Object(T.jsx)(d.a,{position:"absolute",bottom:0,p:2,children:Object(T.jsx)(b.a,{sx:{border:"2px solid red"},children:Object(T.jsxs)(d.a,{p:2,textAlign:"center",children:[Object(T.jsxs)(O.a,{children:["React App status is: ",Object(v.g)()]}),Object(T.jsxs)(O.a,{children:["Name: ",null===l||void 0===l?void 0:l.username,", Role:"," ",null!==l&&void 0!==l&&l.isInstructor?"Instructor":"Learner"]}),Object(T.jsxs)(O.a,{children:["Session ID is: ",null===l||void 0===l?void 0:l.sessionId]}),"Session is: ",r?"EXPIRED":"VALID"]})})})};var A=function(e){return Object(T.jsx)(d.a,{mt:6,children:Object(T.jsx)(O.a,{variant:"h3",children:"Tokens"})})},B=Object(c.createContext)({apiUrl:"",contextId:"",isInstructor:!1,linkId:"",sessionId:"",username:"",darkMode:!1,baseColor:""}),P=n(8),L=n(229),z=n(230),U=n(232),W=n(247),N=n(237),M=n(235),F=n(262),H=n(252),J=n(246),Y=n(253),G=n(254),V=n(255),K=n(256),Q=n(257),X=n(32),$=n(3),Z=n(212),ee=n(241),te=n(248),ne=n(218),ce=n(179),re=n(250),ae=n(239),ie=n(233);var se=function(e){var t=e.rows,n=e.filters,r=e.filterRows,a=e.buttonLabel,i=Object(c.useState)({}),o=Object(s.a)(i,2),l=o[0],j=o[1],u=Object(c.useState)({}),b=Object(s.a)(u,2),x=b[0],h=b[1],f=Object(c.useState)(null),p=Object(s.a)(f,2),m=p[0],v=p[1],g=Boolean(m),y=g?"filter-popover":void 0;Object(c.useEffect)((function(){var e={},c={};t.forEach((function(t){n.forEach((function(n){_(e,n.column,t),_(c,n.column,t)}))})),h(c),j(e)}),[t,n]);var _=function(e,t,n){e[t]?e[t][n[t]]=!0:e[t]=Object($.a)({},n[t],!0)},S=function(e){v(e.currentTarget)},k=function(e){return!Object.keys(x[e]).find((function(t){return!1===x[e][t]}))},w=function(){var e,c=t,a=Object(X.a)(n);try{var i=function(){var t=e.value;c=c.filter((function(e){if("enum"===t.type&&!x[t.column][e[t.column]])return!1;return!0}))};for(a.s();!(e=a.n()).done;)i()}catch(s){a.e(s)}finally{a.f()}r(c)},C=function(e){var t=Object.keys(l[e.column]);return e.sort?t.sort(e.sort):t.sort(),t};return Object(T.jsxs)(d.a,{display:"flex",justifyContent:"end",children:[a?Object(T.jsx)(ee.a,{"aria-describedby":y,endIcon:Object(T.jsx)(Z.a,{}),variant:"outlined",onClick:S,children:"Filters"}):Object(T.jsx)(W.a,{disableRipple:!0,"aria-describedby":y,onClick:S,children:Object(T.jsx)(Z.a,{})}),Object(T.jsx)(te.a,{id:y,open:g,anchorEl:m,onClose:function(){v(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(T.jsx)(d.a,{display:"flex",flexWrap:"wrap",children:n.map((function(e,t){return Object(T.jsxs)(d.a,{p:2,children:[Object(T.jsx)(ne.a,{children:e.label}),"enum"===e.type?Object(T.jsx)(d.a,{display:"flex",children:l[e.column]&&Object(T.jsxs)(ce.a,{children:[Object(T.jsx)(re.a,{control:Object(T.jsx)(ae.a,{size:"small",color:"default",checked:k(e.column),indeterminate:!k(e.column)&&(n=e.column,!!Object.keys(x[n]).find((function(e){return!0===x[n][e]}))),onClick:function(){return function(e){var t=!0,n=k(e);for(var c in t=!n,x[e])x[e][c]=t;h(Object(P.a)({},x)),w(),console.log(e," all ",n)}(e.column)}}),label:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Select all"})}),C(e).map((function(t,n){return Object(T.jsx)(d.a,{children:Object(T.jsx)(re.a,{control:Object(T.jsx)(ae.a,{size:"small",color:"default",checked:!0===x[e.column][t],onClick:function(){return function(e,t){x[e][t]=!x[e][t],h(Object(P.a)({},x)),w()}(e.column,t)}}),label:e.valueMapping?e.valueMapping(t):t})},"".concat(e.column,"-").concat(n,"-").concat(t))}))]})}):Object(T.jsx)(d.a,{children:Object(T.jsx)(ie.a,{size:"small",type:e.type})})]},"".concat(e.column,"-").concat(t));var n}))})})]})},oe=n(242),le=n(219);var je=function(e){var t,n=e.column,c=e.columnLabel,r=e.order,a=e.orderBy,i=e.setOrder,s=e.setOrderBy;return Object(T.jsxs)(oe.a,{active:a===n,direction:a===n?r:"asc",onClick:(t=n,function(e){!function(e,t){i(a===t&&"asc"===r?"desc":"asc"),s(t)}(0,t)}),children:[c,a===n?Object(T.jsx)(d.a,{component:"span",sx:le.a,children:"desc"===r?"sorted descending":"sorted ascending"}):null]})};var ue=function(e){var t=e.rows,n=e.setTabPosition,r=Object(c.useState)(t),a=Object(s.a)(r,2),i=a[0],o=a[1],l=Object(c.useState)("pendingRequests"),j=Object(s.a)(l,2),u=j[0],b=j[1],x=Object(c.useState)("pendingRequests"===u?"desc":"asc"),h=Object(s.a)(x,2),f=h[0],p=h[1];Object(c.useEffect)((function(){o(t)}),[t]);var g=Object(v.k)(i,Object(v.f)(f,u));return Object(T.jsxs)(d.a,{children:[Object(T.jsx)(d.a,{mb:1,children:Object(T.jsx)(se,{buttonLabel:"Filters",rows:t,filters:m.d.INSTRUCTOR.BALANCES,filterRows:o})}),Object(T.jsx)(H.a,{component:J.a,children:Object(T.jsxs)(Y.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(T.jsx)(G.a,{children:Object(T.jsxs)(V.a,{children:[Object(T.jsx)(K.a,{align:"center",width:190,children:Object(T.jsx)(je,{column:"pendingRequests",columnLabel:"Pending Requests",order:f,orderBy:u,setOrder:p,setOrderBy:b})}),Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"learner_name",columnLabel:"Student Name",order:f,orderBy:u,setOrder:p,setOrderBy:b})}),Object(T.jsx)(K.a,{align:"center",children:Object(T.jsx)(je,{column:"tokens_used",columnLabel:"Tokens Used",order:f,orderBy:u,setOrder:p,setOrderBy:b})}),Object(T.jsx)(K.a,{align:"center",children:Object(T.jsx)(je,{column:"balance",columnLabel:"Balance Remaining",order:f,orderBy:u,setOrder:p,setOrderBy:b})})]})}),Object(T.jsx)(Q.a,{children:g.length?g.map((function(e,t){return Object(T.jsxs)(V.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(T.jsx)(K.a,{align:"center",children:Object(T.jsx)(d.a,{display:"flex",minHeight:35,justifyContent:"center",alignContent:"center",children:e.pendingRequests&&Object(T.jsx)(W.a,{onClick:function(){return n(1)},disableRipple:!0,children:Object(T.jsx)(N.a,{badgeContent:e.pendingRequests,color:"warning"})})})}),Object(T.jsx)(K.a,{children:e.learner_name}),Object(T.jsx)(K.a,{align:"center",children:e.tokens_used}),Object(T.jsx)(K.a,{align:"center",children:e.balance})]},"".concat(t,"-").concat(e.user_id))})):Object(T.jsx)(V.a,{children:Object(T.jsx)(K.a,{colSpan:4,sx:{textAlign:"center"},children:Object(T.jsx)(O.a,{children:"No results"})})})})]})})]})},de=n(220),be=n(221),Oe=n(222),xe={ACCEPTED:{icon:Object(T.jsx)(de.a,{color:"success"}),text:"Accepted",tooltip:"Request has been accepted"},PENDING:{icon:Object(T.jsx)(be.a,{color:"warning"}),text:"Pending",tooltip:"Request has not yet been accepted or rejected"},REJECTED:{icon:Object(T.jsx)(Oe.a,{color:"error"}),text:"Rejected",tooltip:"Request has been rejected"},SUBMITTED:{icon:Object(T.jsx)(be.a,{color:"warning"}),text:"Pending",tooltip:"Request has not yet been accepted or rejected"}};var he=function(e){var t=e.status,n=e.iconOnly;return Object(T.jsxs)(d.a,{display:"flex",alignItems:"center",children:[Object(T.jsx)(d.a,{display:"flex",alignItems:"center",children:Object(T.jsx)(U.a,{title:xe[t].tooltip,children:xe[t].icon})}),!n&&Object(T.jsx)(O.a,{sx:{ml:1},children:xe[t].text})]})};var fe=function(e){var t=e.rows,n=e.filters,r=e.openReviewDialog,a=Object(c.useContext)(B),i=Object(c.useState)(t),l=Object(s.a)(i,2),j=l[0],u=l[1],b=Object(v.i)(Object(o.a)()),x=Object(c.useState)("updated_at"),h=Object(s.a)(x,2),f=h[0],p=h[1],m=Object(c.useState)("updated_at"===f?"desc":"asc"),g=Object(s.a)(m,2),y=g[0],_=g[1];Object(c.useEffect)((function(){t.forEach((function(e){e.status_name="SUBMITTED"===e.status_name?"PENDING":e.status_name})),u(t)}),[t]);var S=Object(v.k)(j,Object(v.f)(y,f));return Object(T.jsxs)(d.a,{children:[Object(T.jsx)(d.a,{mb:1,children:Object(T.jsx)(se,{buttonLabel:"Filters",rows:t,filters:n,filterRows:u})}),Object(T.jsx)(H.a,{component:J.a,children:Object(T.jsxs)(Y.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(T.jsx)(G.a,{children:Object(T.jsxs)(V.a,{children:[Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"updated_at",columnLabel:"Last Action",order:y,orderBy:f,setOrder:_,setOrderBy:p})}),a.isInstructor&&Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"learner_name",columnLabel:"Student Name",order:y,orderBy:f,setOrder:_,setOrderBy:p})}),Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"category_name",columnLabel:"Request",order:y,orderBy:f,setOrder:_,setOrderBy:p})}),Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"status_name",columnLabel:"Status",order:y,orderBy:f,setOrder:_,setOrderBy:p})}),Object(T.jsx)(K.a,{align:"center",children:"Action"})]})}),Object(T.jsx)(Q.a,{children:S.length?S.map((function(e,t){return Object(T.jsxs)(V.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(T.jsx)(K.a,{sx:{borderLeft:"5px solid ".concat(b[e.status_name]," !important")},children:Object(v.d)(e.updated_at)}),a.isInstructor&&Object(T.jsx)(K.a,{component:"th",scope:"row",children:e.learner_name}),Object(T.jsx)(K.a,{children:e.category_name}),Object(T.jsx)(K.a,{children:Object(T.jsx)(he,{status:e.status_name})}),Object(T.jsx)(K.a,{align:"center",children:Object(T.jsx)(ee.a,{variant:"contained",onClick:function(){return r(e.request_id)},children:"Review"})})]},"".concat(t,"-").concat(e.request_id))})):Object(T.jsx)(V.a,{children:Object(T.jsx)(K.a,{colSpan:5,sx:{textAlign:"center"},children:Object(T.jsx)(O.a,{children:"No results"})})})})]})})]})};var pe=function(e){var t=e.rows,n=e.openReviewDialog,r=Object(c.useState)(t),a=Object(s.a)(r,2),i=a[0],o=a[1],l=Object(c.useState)("created_at"),j=Object(s.a)(l,2),u=j[0],b=j[1],x=Object(c.useState)("created_at"===u?"desc":"asc"),h=Object(s.a)(x,2),f=h[0],p=h[1];Object(c.useEffect)((function(){o(t)}),[t]);var g=Object(v.k)(i,Object(v.f)(f,u));return Object(T.jsxs)(d.a,{children:[Object(T.jsx)(d.a,{mb:1,children:Object(T.jsx)(se,{buttonLabel:"Filters",rows:t,filters:m.d.INSTRUCTOR.REQUESTS,filterRows:o})}),Object(T.jsx)(H.a,{component:J.a,children:Object(T.jsxs)(Y.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(T.jsx)(G.a,{children:Object(T.jsxs)(V.a,{children:[Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"created_at",columnLabel:"Request Date",order:f,orderBy:u,setOrder:p,setOrderBy:b})}),Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"learner_name",columnLabel:"Student Name",order:f,orderBy:u,setOrder:p,setOrderBy:b})}),Object(T.jsx)(K.a,{children:Object(T.jsx)(je,{column:"category_name",columnLabel:"Request",order:f,orderBy:u,setOrder:p,setOrderBy:b})}),Object(T.jsx)(K.a,{children:"Description"}),Object(T.jsx)(K.a,{align:"center",children:"Action"})]})}),Object(T.jsx)(Q.a,{children:g.length?g.map((function(e,t){return Object(T.jsxs)(V.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(T.jsx)(K.a,{children:Object(v.d)(e.created_at)}),Object(T.jsx)(K.a,{children:e.learner_name}),Object(T.jsx)(K.a,{children:e.category_name}),Object(T.jsx)(K.a,{sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.learner_comment}),Object(T.jsx)(K.a,{align:"center",children:Object(T.jsx)(ee.a,{variant:"contained",onClick:function(){return n(e.request_id)},children:"Review"})})]},"".concat(t,"-").concat(e.request_id))})):Object(T.jsx)(V.a,{children:Object(T.jsx)(K.a,{colSpan:4,sx:{textAlign:"center"},children:Object(T.jsx)(O.a,{children:"No results"})})})})]})})]})},me=n(258),ve=n(223),ge=n(259),ye=n(260),_e=n(240),Se=n(224),ke=n(238),we=n(261),Ce={large:{color:"black",fontSize:"150px",outerRim:{size:"300px",color:"#DDCB6B",border:"4px dotted #CBB95A"},innerRim:{size:"250px",color:"#AA8500",border:"none"},inner:{size:"245px",color:"#CBB95A",border:"none"}},small:{color:"black",fontSize:"18px",outerRim:{size:"30px",color:"#DDCB6B",border:"none"},innerRim:{size:"24px",color:"#AA8500",border:"none"},inner:{size:"22px",color:"#CBB95A",border:"none"}},disabled:{color:"#888",outerRim:{color:"#ccc"},innerRim:{color:"#aaa"},inner:{color:"#bbb"}}};var Ee=function(e){var t=e.count,n=e.disabled,c=e.size,r="small"===c&&t>1,a=function(e){return{height:Ce[c][e].size,width:Ce[c][e].size,borderRadius:50,border:Ce[c][e].border,sx:{backgroundColor:n?Ce.disabled[e].color:Ce[c][e].color,fontSize:Ce[c].fontSize,color:n?Ce.disabled.color:Ce[c].color},display:"flex",justifyContent:"center",alignItems:"center"}};return Object(T.jsxs)(d.a,{position:"relative",children:[Object(T.jsx)(d.a,Object(P.a)(Object(P.a)({},a("outerRim")),{},{position:r?"absolute":"inherit",left:r?5:0,border:Ce[c].outerRim.border,children:Object(T.jsx)(d.a,Object(P.a)(Object(P.a)({},a("innerRim")),{},{children:Object(T.jsx)(d.a,Object(P.a)(Object(P.a)({},a("inner")),{},{children:t}))}))})),r&&Object(T.jsx)(d.a,Object(P.a)(Object(P.a)({},a("outerRim")),{},{border:Ce[c].outerRim.border,children:Object(T.jsx)(d.a,Object(P.a)(Object(P.a)({},a("innerRim")),{},{children:Object(T.jsx)(d.a,Object(P.a)({},a("inner")))}))}))]})};var Ie=function(e){var t=e.handleClose,n=e.handleSave,r=e.open,a=e.requestRow,i=Object(c.useContext)(B),o=Object(c.useState)(),l=Object(s.a)(o,2),j=l[0],u=l[1],b=Object(c.useState)(),x=Object(s.a)(b,2),h=x[0],f=x[1],p=Object(c.useState)(!0),m=Object(s.a)(p,2),g=m[0],y=m[1];return Object(c.useEffect)((function(){r&&(u(void 0),f(void 0))}),[r]),Object(c.useEffect)((function(){y(!i.isInstructor||"SUBMITTED"!==(null===a||void 0===a?void 0:a.status_name))}),[i,a]),Object(T.jsx)(me.a,{open:r,onClose:t,children:a&&Object(T.jsx)(d.a,{p:2,children:Object(T.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),a&&j){var t={request_id:a.request_id,status_name:j};"REJECTED"===j&&(t.instructor_comment=h),n(t)}},children:[Object(T.jsx)(ve.a,{children:"Review Request"}),Object(T.jsxs)(ge.a,{children:[Object(T.jsx)(d.a,{mb:3,children:Object(T.jsx)(ye.a,{children:"Review or take action on a token request."})}),Object(T.jsxs)(d.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(T.jsx)(d.a,{mr:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Date:"})})}),Object(T.jsx)(O.a,{children:Object(v.d)(a.created_at)})]}),Object(T.jsxs)(d.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(T.jsx)(d.a,{mr:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Requester:"})})}),Object(T.jsx)(O.a,{children:a.learner_name})]}),Object(T.jsxs)(d.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(T.jsx)(d.a,{mr:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Type:"})})}),Object(T.jsx)(O.a,{children:a.category_name}),Object(T.jsx)(d.a,{ml:1,children:Object(T.jsx)(Ee,{size:"small",count:a.token_cost})})]}),Object(T.jsxs)(d.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(T.jsx)(d.a,{mb:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Requester Description:"})})}),Object(T.jsx)(d.a,{pl:2,children:Object(T.jsx)(ie.a,{fullWidth:!0,"aria-label":"Description of request as made by the requester",value:a.learner_comment||"",multiline:!0,minRows:1,maxRows:6,InputProps:{readOnly:!0}})})]}),g?Object(T.jsxs)(d.a,{children:[Object(T.jsxs)(d.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(T.jsx)(d.a,{mr:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Instructor Action:"})})}),Object(T.jsx)(he,{status:a.status_name})]}),"SUBMITTED"!==a.status_name&&Object(T.jsxs)(d.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(T.jsx)(d.a,{mr:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Action Date:"})})}),Object(T.jsx)(O.a,{children:Object(v.d)(a.status_updated_at)})]}),"REJECTED"===a.status_name&&Object(T.jsxs)(d.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(T.jsx)(d.a,{mb:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Instructor Comment:"})})}),Object(T.jsx)(d.a,{pl:2,children:Object(T.jsx)(ie.a,{fullWidth:!0,"aria-label":"A comment on the request made by the instructor",value:a.instructor_comment||"",multiline:!0,minRows:1,maxRows:6,InputProps:{readOnly:!0}})})]})]}):Object(T.jsxs)(d.a,{children:[Object(T.jsxs)(_e.a,{children:[Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Instructor Action:"})}),Object(T.jsx)(d.a,{pl:2,children:Object(T.jsxs)(Se.a,{id:"instructor-action",name:"instructor-action","aria-labelledby":"instructor-action",onChange:function(e){var t=e.target.value;"ACCEPTED"===t&&f(""),u(t)},children:[Object(T.jsx)(re.a,{value:"ACCEPTED",control:Object(T.jsx)(ke.a,{required:!0}),label:"Accept"}),Object(T.jsx)(re.a,{value:"REJECTED",control:Object(T.jsx)(ke.a,{required:!0}),label:"Reject"})]})})]}),"REJECTED"===j&&Object(T.jsxs)(d.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(T.jsx)(d.a,{mb:2,children:Object(T.jsx)(ne.a,{children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Instructor Comment:"})})}),Object(T.jsx)(d.a,{pl:2,children:Object(T.jsx)(ie.a,{fullWidth:!0,required:!0,"aria-label":"An input for the instructor to comment on the request",multiline:!0,rows:6,value:h,onChange:function(e){var t=e.target.value;f(t)}})})]})]})]}),Object(T.jsxs)(we.a,{children:[Object(T.jsx)(ee.a,{onClick:t,variant:"outlined",children:g?"Close":"Cancel"}),!g&&Object(T.jsx)(ee.a,{variant:"contained",type:"submit",children:"Save"})]})]})})})},Re=n(225),De=n(226),Te=n(227),qe=n(228),Ae=n(251),Be=n(59),Pe=n(90);var Le=function(e){var t=e.handleClose,n=e.handleSave,r=e.open,a=e.settings,i=Object(Pe.b)({defaultValues:{categories:[{category_name:"Missed Class",token_cost:1,dbAction:"ADD",sort_order:0},{category_name:"Late Assignment",token_cost:1,dbAction:"ADD",sort_order:1}]}}),s=i.control,o=i.register,l=i.handleSubmit,j=i.watch,u=i.setValue,b=i.formState.errors,x=Object(Pe.a)({control:s,name:"categories"}),h=x.fields,f=x.append,p=x.move,v=x.update,g=x.remove,y=j("notifications_pref",!0),_=Object(c.useCallback)((function(e){var t=Be.DateTime.fromFormat(e.use_by_date,m.b).toISODate();u("configuration_id",e.configuration_id),u("initial_tokens",e.initial_tokens),u("notifications_pref",e.notifications_pref),u("use_by_date",t),u("categories",e.categories)}),[u]);return Object(c.useEffect)((function(){a&&r&&_(a)}),[a,r,_]),Object(T.jsx)(me.a,{open:r,onClose:t,children:Object(T.jsx)(d.a,{p:2,children:Object(T.jsxs)("form",{onSubmit:l((function(e){var t={configuration_id:null===a||void 0===a?void 0:a.configuration_id,initial_tokens:"number"===typeof e.initial_tokens?e.initial_tokens:parseInt(e.initial_tokens),use_by_date:e.use_by_date,notifications_pref:e.notifications_pref,categories:e.categories};t.categories.forEach((function(e,t){e.sort_order=t,e.category_id&&!e.dbAction?e.dbAction="UPDATE":e.category_id||e.dbAction||(e.dbAction="ADD")})),n(t)})),children:[Object(T.jsx)(ve.a,{children:"Instructor Settings"}),Object(T.jsxs)(ge.a,{children:[a&&Object(T.jsx)(d.a,{mb:3,children:Object(T.jsx)(ye.a,{children:"View or update the settings for your token economy."})}),Object(T.jsxs)(d.a,{display:"flex",mt:1,mb:2,children:[Object(T.jsx)(d.a,{minWidth:300,width:300,mr:2,mt:1,children:Object(T.jsx)(Ae.a,{htmlFor:"token-count",sx:{whiteSpace:"normal"},children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Amount of tokens to be available for each student:"})})}),Object(T.jsx)(d.a,{minWidth:150,width:150,children:Object(T.jsx)(ie.a,Object(P.a)(Object(P.a)({autoFocus:!0,margin:"dense",size:"small",id:"token-count",type:"number",error:!!b.initial_tokens,InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{textAlign:"center"}}}},o("initial_tokens",{required:!0,pattern:/^[0-9]+$/,min:1})),{},{helperText:b.initial_tokens&&"Must be a positive whole number"}))})]}),Object(T.jsxs)(d.a,{display:"flex",mb:2,children:[Object(T.jsx)(d.a,{minWidth:300,mr:2,mt:2,children:Object(T.jsx)(Ae.a,{htmlFor:"use-by-date",children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Date that tokens must be used by:"})})}),Object(T.jsx)(d.a,{children:Object(T.jsx)(ie.a,Object(P.a)(Object(P.a)({margin:"dense",size:"small",id:"use-by-date",type:"date",error:!!b.use_by_date,InputLabelProps:{shrink:!1}},o("use_by_date",{required:!0})),{},{helperText:b.use_by_date&&"Must be a valid date"}))})]}),Object(T.jsxs)(d.a,{mb:2,children:[Object(T.jsxs)(d.a,{display:"flex",justifyContent:"start",alignItems:"center",children:[Object(T.jsx)(d.a,{mr:3,children:Object(T.jsx)(Ae.a,{htmlFor:"email-pref",children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Email notifications:"})})}),Object(T.jsx)(ae.a,Object(P.a)({color:"default",checked:!!y,inputProps:{"aria-label":"Email notifications preference checkbox"}},o("notifications_pref")))]}),Object(T.jsx)(d.a,{mb:3,children:Object(T.jsx)(O.a,{variant:"body2",children:"Receive emails when students use tokens."})})]}),Object(T.jsxs)(d.a,{display:"flex",flexDirection:"column",children:[Object(T.jsxs)(d.a,{display:"flex",children:[Object(T.jsx)(d.a,{minWidth:330,mr:2,children:Object(T.jsx)(Ae.a,{htmlFor:"category-name-input-0",children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Categories:"})})}),Object(T.jsxs)(d.a,{minWidth:150,width:150,display:"flex",alignItems:"center",children:[Object(T.jsx)(U.a,{title:"The amount of tokens a student would need to spend.",placement:"top",children:Object(T.jsx)(Re.a,{sx:{mr:1},fontSize:"small"})}),Object(T.jsx)(Ae.a,{htmlFor:"category-token-input-0",children:Object(T.jsx)(O.a,{fontWeight:"bold",children:"Token Cost:"})})]})]}),Object(T.jsx)(d.a,{display:"flex",flexDirection:"column",children:h.map((function(e,t){var n,c,r,a,i,s,l,j;return Object(T.jsx)(d.a,{children:"DELETE"!==e.dbAction&&Object(T.jsxs)(d.a,{display:"flex",children:[Object(T.jsxs)(d.a,{children:[Object(T.jsx)(W.a,{size:"small",disabled:0===t,disableRipple:!0,onClick:function(){return function(e){p(e,e-1)}(t)},children:Object(T.jsx)(De.a,{fontSize:"small"})}),Object(T.jsx)(W.a,{size:"small",disabled:t===h.length-1,disableRipple:!0,onClick:function(){return function(e){p(e,e+1)}(t)},children:Object(T.jsx)(Te.a,{fontSize:"small"})})]}),Object(T.jsx)(d.a,{minWidth:300,mr:2,children:Object(T.jsx)(ie.a,Object(P.a)({margin:"dense",size:"small",id:"category-name-".concat(t),type:"text",placeholder:"Enter category name...",InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{minWidth:250}}},helperText:(null===(n=b.categories)||void 0===n||null===(c=n[t])||void 0===c?void 0:c.category_name)&&"A category name is required",error:!(null===(r=b.categories)||void 0===r||null===(a=r[t])||void 0===a||!a.category_name)},o("categories.".concat(t,".category_name"),{required:!0})))}),Object(T.jsxs)(d.a,{display:"flex",alignItems:"start",minWidth:200,children:[Object(T.jsx)(d.a,{minWidth:150,width:150,children:Object(T.jsx)(ie.a,Object(P.a)({disabled:e.is_used,margin:"dense",size:"small",id:"category-token-".concat(t),type:"number",InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{textAlign:"center"}}},error:!(null===(i=b.categories)||void 0===i||null===(s=i[t])||void 0===s||!s.token_cost),helperText:(null===(l=b.categories)||void 0===l||null===(j=l[t])||void 0===j?void 0:j.token_cost)&&"Must be a positive whole number"},o("categories.".concat(t,".token_cost"),{required:!0,pattern:/^[0-9]+$/,min:1})))}),Object(T.jsx)(d.a,{ml:1,mt:1,children:Object(T.jsx)(U.a,{title:e.is_used?"Category is associated with a request and cannot be deleted":"",children:Object(T.jsx)("div",{children:Object(T.jsx)(W.a,{disabled:e.is_used||h.filter((function(e){return"DELETE"!==e.dbAction})).length<=1,onClick:function(){var e;h[e=t].category_id?(h[e].dbAction="DELETE",v(e,Object(P.a)(Object(P.a)({},h[e]),{},{dbAction:"DELETE"}))):g(e)},children:Object(T.jsx)(Oe.a,{})})})})})]})]})},e.id)}))}),Object(T.jsx)(d.a,{mt:2,children:Object(T.jsx)(ee.a,{variant:"contained",startIcon:Object(T.jsx)(qe.a,{}),onClick:function(){f({sort_order:h.length})},children:"New Category"})})]})]}),Object(T.jsxs)(we.a,{children:[(null===a||void 0===a?void 0:a.configuration_id)&&Object(T.jsx)(ee.a,{onClick:t,variant:"outlined",children:"Cancel"}),Object(T.jsx)(ee.a,{variant:"contained",type:"submit",children:"Save"})]})]})})})},ze=n(48),Ue=["children","value","index"];var We=function(e){var t=e.children,n=e.value,c=e.index,r=Object(ze.a)(e,Ue);return Object(T.jsx)("div",Object(P.a)(Object(P.a)({role:"tabpanel",hidden:n!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},r),{},{children:n===c&&Object(T.jsx)(d.a,{sx:{p:3},children:t})}))};var Ne=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(s.a)(a,2),o=i[0],l=i[1],j=Object(c.useState)(!1),u=Object(s.a)(j,2),b=u[0],O=u[1],f=Object(c.useState)(),p=Object(s.a)(f,2),g=p[0],y=p[1],I=Object(c.useState)(new Map),R=Object(s.a)(I,2),D=R[0],q=R[1],A=Object(c.useState)([]),B=Object(s.a)(A,2),H=B[0],J=B[1],Y=Object(c.useState)([]),G=Object(s.a)(Y,2),V=G[0],K=G[1],Q=Object(c.useState)([]),X=Object(s.a)(Q,2),$=X[0],Z=X[1],ee=Object(c.useState)(),te=Object(s.a)(ee,2),ne=te[0],ce=te[1];Object(c.useEffect)((function(){re()}),[]),Object(c.useEffect)((function(){var e=new Map;V.forEach((function(t){e.get(t.user_id)?e.set(t.user_id,e.get(t.user_id)+1):e.set(t.user_id,1)})),q(e)}),[V]),Object(c.useEffect)((function(){D.size&&g&&w().then((function(e){var t=Object(v.j)(e,D);t.forEach((function(e){e.pendingRequests=D.get(e.user_id),e.balance=(g.initial_tokens||0)-(e.tokens_used||0)})),J(t)}))}),[D,g]),Object(c.useEffect)((function(){null===g&&O(!0)}),[g]);var re=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t,n,c;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,y(t),e.next=6,C();case 6:(n=e.sent).sort(v.b),c=n.filter((function(e){return"SUBMITTED"===e.status_name})),K(c),Z(n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(h.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.configuration_id){e.next=5;break}return e.next=3,k(t);case 3:e.next=7;break;case 5:return e.next=7,S(t);case 7:return O(!1),e.next=10,_();case 10:n=e.sent,y(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(h.a)(Object(x.a)().mark((function e(t){return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!1),e.next=3,E(t);case 3:return e.next=5,re();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(T.jsxs)(T.Fragment,{children:[g&&Object(T.jsxs)(d.a,{children:[Object(T.jsxs)(d.a,{display:"flex",justifyContent:"end",mr:1,mb:2,children:[Object(T.jsx)(U.a,{title:"There are pending requests requiring review",children:Object(T.jsx)(W.a,{onClick:function(){return r(1)},children:Object(T.jsx)(N.a,{badgeContent:V.length,color:"warning",children:Object(T.jsx)(L.a,{})})})}),Object(T.jsx)(U.a,{title:"Review or update Tokens settings",children:Object(T.jsx)(W.a,{onClick:function(){O(!0)},children:Object(T.jsx)(z.a,{})})})]}),Object(T.jsx)(d.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(T.jsxs)(M.a,{value:n,onChange:function(e,t){r(t)},"aria-label":"basic tabs example",children:[Object(T.jsx)(F.a,Object(P.a)({label:"Balances"},Object(v.a)(0))),Object(T.jsx)(F.a,Object(P.a)({label:"Requests"},Object(v.a)(1))),Object(T.jsx)(F.a,Object(P.a)({label:"History"},Object(v.a)(2)))]})}),Object(T.jsx)(We,{value:n,index:0,children:Object(T.jsx)(ue,{rows:H,setTabPosition:r})}),Object(T.jsx)(We,{value:n,index:1,children:Object(T.jsx)(pe,{rows:V,openReviewDialog:function(e){ce(V.find((function(t){return t.request_id===e}))),l(!0)}})}),Object(T.jsx)(We,{value:n,index:2,children:Object(T.jsx)(fe,{rows:$,filters:m.d.INSTRUCTOR.HISTORY,openReviewDialog:function(e){ce($.find((function(t){return t.request_id===e}))),l(!0)}})})]}),Object(T.jsx)(Le,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||O(!1)},handleSave:ae,open:b,settings:g||null}),Object(T.jsx)(Ie,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||l(!1)},handleSave:ie,open:o,requestRow:ne||null})]})};var Me=function(e){var t=e.balance;return Object(T.jsxs)(d.a,{children:[Object(T.jsx)(d.a,{mb:4,display:"flex",justifyContent:"center",children:Object(T.jsx)(O.a,{fontSize:30,children:"Token Balance"})}),Object(T.jsx)(d.a,{display:"flex",justifyContent:"center",children:Object(T.jsx)(Ee,{count:t,size:"large"})})]})};function Fe(e){var t=e.handleClose,n=e.handleConfirm,c=e.open;return Object(T.jsx)("div",{children:Object(T.jsxs)(me.a,{open:c,onClose:t,"aria-labelledby":"confirmation-dialog-title","aria-describedby":"confirmation-dialog-description",children:[Object(T.jsx)(ve.a,{id:"confirmation-dialog-title",children:"Confirmation"}),Object(T.jsx)(ge.a,{children:Object(T.jsx)(ye.a,{id:"confirmation-dialog-description",children:"Are you sure you want to submit this token request?"})}),Object(T.jsxs)(we.a,{children:[Object(T.jsx)(ee.a,{onClick:t,variant:"outlined",children:"Cancel"}),Object(T.jsx)(ee.a,{onClick:n,autoFocus:!0,variant:"contained",children:"Confirm"})]})]})})}var He=function(e){var t=e.balance,n=e.categories,r=e.updateBalance,a=e.resetBalance,i=e.refreshData,o=n.sort((function(e,t){return e.sort_order-t.sort_order})),l=Object(c.useState)(!1),j=Object(s.a)(l,2),u=j[0],b=j[1],f=Object(c.useState)(!1),p=Object(s.a)(f,2),m=p[0],v=p[1],g=Object(c.useState)(),y=Object(s.a)(g,2),_=y[0],S=y[1],k=Object(c.useState)(""),w=Object(s.a)(k,2),C=w[0],E=w[1],I=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===_||void 0===_||!_.category_id||!C){e.next=7;break}return b(!1),e.next=4,D(_.category_id,C);case 4:return e.next=6,i();case 6:v(!0);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)(d.a,{children:[_?Object(T.jsx)(T.Fragment,{children:m?Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(d.a,{mb:4,children:Object(T.jsx)(O.a,{fontSize:30,children:"Submitted"})}),Object(T.jsxs)(d.a,{mb:4,children:[Object(T.jsxs)(d.a,{display:"flex",alignItems:"center",mb:2,children:[Object(T.jsx)(O.a,{sx:{mr:2},variant:"h6",children:_.category_name}),Object(T.jsx)(Ee,{count:_.token_cost,size:"small"})]}),Object(T.jsx)(O.a,{sx:{mb:2},children:"Your request has been submitted to the instructor for review."}),Object(T.jsx)(O.a,{children:"If they have any further questions about your request, they will reach out via email."})]}),Object(T.jsx)(d.a,{display:"flex",justifyContent:"end",pt:2,children:Object(T.jsx)(ee.a,{onClick:function(){S(void 0),v(!1)},variant:"contained",children:"Dismiss"})})]}):Object(T.jsxs)("form",{onSubmit:function(e){e.preventDefault(),b(!0)},children:[Object(T.jsx)(d.a,{mb:4,children:Object(T.jsx)(O.a,{fontSize:30,children:"Request"})}),Object(T.jsxs)(d.a,{mb:4,children:[Object(T.jsxs)(d.a,{display:"flex",alignItems:"center",mb:2,children:[Object(T.jsx)(O.a,{sx:{mr:2},variant:"h6",children:_.category_name}),Object(T.jsx)(Ee,{count:_.token_cost,size:"small"})]}),Object(T.jsxs)(O.a,{children:["Please list the details of the activity on which you plan to use your token",_.token_cost>1&&"s",":"]})]}),Object(T.jsx)(d.a,{display:"flex",flexDirection:"column",children:Object(T.jsx)(ie.a,{fullWidth:!0,required:!0,"aria-label":"Details about the request to be submitted",multiline:!0,rows:4,onChange:function(e){return E(e.target.value)}})}),Object(T.jsxs)(d.a,{display:"flex",justifyContent:"end",pt:2,children:[Object(T.jsx)(ee.a,{onClick:function(){S(void 0),a()},variant:"outlined",sx:{mr:1},children:"Cancel"}),Object(T.jsx)(ee.a,{variant:"contained",type:"submit",children:"Submit"})]})]})}):Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(d.a,{mb:4,children:Object(T.jsx)(O.a,{fontSize:30,children:"Request"})}),Object(T.jsx)(d.a,{mb:4,children:Object(T.jsx)(O.a,{children:"Use tokens by selecting one of the requests below."})}),Object(T.jsx)(d.a,{display:"flex",flexDirection:"column",children:o.map((function(e){return Object(T.jsx)(ee.a,{disabled:t-e.token_cost<0,size:"large",sx:{mb:2},variant:"contained",onClick:function(){return function(e){r(t-e.token_cost),S(e)}(e)},children:Object(T.jsxs)(d.a,{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center",children:[Object(T.jsx)(O.a,{textTransform:"none",children:e.category_name}),Object(T.jsx)(Ee,{count:e.token_cost,size:"small",disabled:t-e.token_cost<0})]})},"category-".concat(e.category_id))}))})]}),Object(T.jsx)(Fe,{handleClose:function(){b(!1)},handleConfirm:I,open:u})]})};var Je=function(e){var t=e.balance,n=e.settings,r=e.refreshData,a=Object(c.useState)(t),i=Object(s.a)(a,2),o=i[0],l=i[1];return Object(c.useEffect)((function(){l(t)}),[t]),Object(T.jsxs)(d.a,{display:"flex",justifyContent:"space-around",pt:3,children:[Object(T.jsx)(d.a,{width:"55%",children:Object(T.jsx)(Me,{balance:o})}),Object(T.jsx)(d.a,{width:"45%",children:Object(T.jsx)(He,{balance:o,updateBalance:l,categories:n.categories,resetBalance:function(){l(t)},refreshData:r})})]})};var Ye=function(){var e=Object(c.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),i=Object(s.a)(a,2),o=i[0],l=i[1],j=Object(c.useState)(!1),u=Object(s.a)(j,2),b=u[0],O=u[1],f=Object(c.useState)([]),p=Object(s.a)(f,2),g=p[0],y=p[1],_=Object(c.useState)(),S=Object(s.a)(_,2),k=S[0],w=S[1],C=Object(c.useState)(0),E=Object(s.a)(C,2),D=E[0],q=E[1];Object(c.useEffect)((function(){A()}),[]);var A=function(){var e=Object(h.a)(Object(x.a)().mark((function e(){var t,n,c;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:return t=e.sent,r(t),e.next=6,R();case 6:(n=e.sent).sort(v.b),y(n),t&&(c=n.reduce((function(e,t){return"REJECTED"===t.status_name?e:e+t.token_cost}),0),q(t.initial_tokens-c));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)(T.Fragment,{children:[n&&Object(T.jsxs)(d.a,{children:[Object(T.jsx)(d.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(T.jsxs)(M.a,{value:o,onChange:function(e,t){l(t)},"aria-label":"basic tabs example",children:[Object(T.jsx)(F.a,Object(P.a)({label:"Request"},Object(v.a)(0))),Object(T.jsx)(F.a,Object(P.a)({label:"History"},Object(v.a)(1)))]})}),Object(T.jsx)(We,{value:o,index:0,children:Object(T.jsx)(Je,{settings:n,balance:D,refreshData:A})}),Object(T.jsx)(We,{value:o,index:1,children:Object(T.jsx)(fe,{rows:g,filters:m.d.LEARNER.HISTORY,openReviewDialog:function(e){w(g.find((function(t){return t.request_id===e}))),O(!0)}})})]}),Object(T.jsx)(Ie,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||O(!1)},handleSave:function(){},open:b,requestRow:k||null})]})};var Ge=function(){var e=Object(c.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){console.info("Running in cra environment: ".concat(Object(v.g)())),y().then((function(e){if(e&&"string"!==typeof e){console.info("Application configuration information retrieved");var t=Object(v.e)(e);r(t)}else console.error("Unable to retrieve App Info - Session may be expired")}))}),[]);var a=Object(o.a)().palette.primary.main,i=Object(l.a)({palette:{primary:{main:(null===n||void 0===n?void 0:n.baseColor)||a},mode:null!==n&&void 0!==n&&n.darkMode?"dark":"light"},components:{MuiTableCell:{styleOverrides:{head:{fontWeight:"bold"}}}}});return Object(T.jsxs)(j.a,{theme:i,children:[Object(T.jsx)(u.a,{}),Object(T.jsx)("div",{className:"App",children:n&&Object(T.jsx)(B.Provider,{value:n,children:Object(T.jsx)(d.a,{display:"flex",className:"App-header",children:Object(T.jsxs)(d.a,{width:"100%",p:4,height:"100vh",display:"flex",flexDirection:"column",children:[Object(T.jsx)(A,{}),Object(T.jsx)(d.a,{children:n.isInstructor?Object(T.jsx)(Ne,{}):Object(T.jsx)(Ye,{})})]})})})}),"pre_build"===Object(v.g)()&&Object(T.jsx)(q,{})]})},Ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,263)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.createRoot(document.getElementById("root")).render(Object(T.jsx)(r.a.StrictMode,{children:Object(T.jsx)(Ge,{})})),Ve()},17:function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m}));var c=n(8),r=n(59),a=n(28),i=function(e){var t=s(),n={};return"pre_build"===t&&(n=a.a),Object(c.a)(Object(c.a)(Object(c.a)({},e),a.c[t]),n)},s=function(){var t;return(null===(t=e)||void 0===t?void 0:"deployed_build")||"production"},o=function(){var e=window.appConfig||null;return(null===e||void 0===e?void 0:e.sessionId)||""},l=function(e){return{ACCEPTED:e.palette.success.main,PENDING:e.palette.warning.main,REJECTED:e.palette.error.main,SUBMITTED:e.palette.warning.main}},j=function(e,t){return e<t?-1:e>t?1:0},u=function(e,t){return d(e.learner_name,t.learner_name)},d=function(e,t){var n=e.split(" "),c=t.split(" "),r=n[n.length-1],a=c[c.length-1];return r===a?j(n[0],c[0]):j(r,a)},b=function(e,t){return new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()},O=function(e,t){e.sort(u);var n=[],c=[];return e.forEach((function(e){t.get(e.user_id)?n.push(e):c.push(e)})),[].concat(n,c)},x=function(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0},h=function(e,t){return"learner_name"===t?"desc"===e?function(e,t){return-u(e,t)}:function(e,t){return u(e,t)}:"desc"===e?function(e,n){return x(e,n,t)}:function(e,n){return-x(e,n,t)}},f=function(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var c=t(e[0],n[0]);return 0!==c?c:e[1]-n[1]})),n.map((function(e){return e[0]}))};function p(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}function m(e,t){return r.DateTime.fromFormat(e,a.b).toLocaleString(r.DateTime.DATETIME_MED||t)}}).call(this,n(83))},28:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o}));var c=n(17),r={sessionId:"81bb972c22521a7bc673b422cdb78544",baseColor:"#0E4466"},a=Object(c.h)(),i={pre_build:{apiUrl:"/learning-apps/mod/mod-tokens/api/index.php",sessionId:r.sessionId||""},local_build:{apiUrl:"/learning-apps/mod/mod-tokens/api/index.php",sessionId:a},deployed_build:{apiUrl:"/mod/tokens/api/index.php",sessionId:a}},s="yyyy-MM-dd HH:mm:ss",o={INSTRUCTOR:{BALANCES:[{column:"learner_name",label:"Learner Name",type:"enum",sort:c.c}],REQUESTS:[{column:"category_name",label:"Request Type",type:"enum"},{column:"learner_name",label:"Learner Name",type:"enum",sort:c.c}],HISTORY:[{column:"category_name",label:"Request Type",type:"enum"},{column:"status_name",label:"Status",type:"enum",valueMapping:function(e){return"SUBMITTED"===e?"Pending":e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}},{column:"learner_name",label:"Learner Name",type:"enum",sort:c.c}]},LEARNER:{HISTORY:[{column:"category_name",label:"Request Type",type:"enum"},{column:"status_name",label:"Status",type:"enum",valueMapping:function(e){return"SUBMITTED"===e?"Pending":e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}}]}}}},[[168,1,2]]]);
//# sourceMappingURL=main.7d9d60b8.chunk.js.map