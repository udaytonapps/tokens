(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{139:function(e,t,n){},140:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(106),i=n.n(a),s=(n(139),n(12)),o=n(27),l=n(111),j=n(236),d=n(224),u=n(237),b=(n(140),n(238)),h=n(177),x=n(15),O=n(19),p=n(40),f=n.n(p),m=n(34),v=n(20),g=m.c[Object(v.e)()],y=function(){var e=Object(O.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/info?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(O.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(O.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,e.next=4,f.a.post("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId),n);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(O.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,e.next=4,f.a.put("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId),n);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(O.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/instructor/balances?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(O.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/instructor/requests?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(O.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("UPDATING request"),e.prev=1,n=t,e.next=5,f.a.put("".concat(g.apiUrl,"/instructor/requests?PHPSESSID=").concat(g.sessionId),n);case 5:return e.abrupt("return");case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),D=n(1);var C=function(e){var t=Object(c.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(),o=Object(s.a)(i,2),l=o[0],j=o[1];return Object(c.useEffect)((function(){y().then((function(e){!e||"string"===typeof e&&e.includes("Session expired")?(console.error("SESSION EXPIRED"),a(!0)):(j(e),a(!1))}))}),[]),Object(D.jsx)(u.a,{position:"absolute",bottom:0,p:2,children:Object(D.jsx)(b.a,{sx:{border:"2px solid red"},children:Object(D.jsxs)(u.a,{p:2,textAlign:"center",children:[Object(D.jsxs)(h.a,{children:["React App status is: ",Object(v.e)()]}),Object(D.jsxs)(h.a,{children:["Session ID is: ",null===l||void 0===l?void 0:l.sessionId]}),"Session is: ",r?"EXPIRED":"VALID"]})})})};var T=function(e){return Object(D.jsx)(u.a,{mt:6,children:Object(D.jsx)(h.a,{variant:"h3",children:"Tokens"})})},q=Object(c.createContext)({apiUrl:"",contextId:"",isInstructor:!1,linkId:"",sessionId:"",username:"",darkMode:!1,baseColor:""}),A=n(10),P=n(222),R=n(223),W=n(225),M=n(240),U=n(231),L=n(228),B=n(254),F=n(241),H=n(239),N=n(242),J=n(243),z=n(244),V=n(245),K=n(246),X=n(210),$=n(211),G=n(212),Q={SUBMITTED:{icon:Object(D.jsx)(X.a,{color:"warning"}),text:"Pending",tooltip:"The request has not yet been accepted or rejected"},ACCEPTED:{icon:Object(D.jsx)($.a,{color:"success"}),text:"Accepted",tooltip:"The request has been accepted"},REJECTED:{icon:Object(D.jsx)(G.a,{color:"error"}),text:"Rejected",tooltip:"The request has been rejected"}};var Y=function(e){var t=e.status,n=e.iconOnly;return Object(D.jsxs)(u.a,{display:"flex",alignItems:"center",children:[Object(D.jsx)(u.a,{display:"flex",alignItems:"center",children:Object(D.jsx)(W.a,{title:Q[t].tooltip,children:Q[t].icon})}),!n&&Object(D.jsx)(h.a,{sx:{ml:1},children:Q[t].text})]})};var Z=function(e){var t=e.initialTokens,n=e.requestMap,c=e.rows,r=e.setTabPosition;return Object(D.jsx)(F.a,{component:H.a,children:Object(D.jsxs)(N.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(D.jsx)(J.a,{children:Object(D.jsxs)(z.a,{children:[Object(D.jsx)(V.a,{}),Object(D.jsx)(V.a,{children:"Student Name"}),Object(D.jsx)(V.a,{align:"center",children:"Balance Remaining"}),Object(D.jsx)(V.a,{align:"center",children:"Tokens Used"})]})}),Object(D.jsx)(K.a,{children:c.length?c.map((function(e,c){return Object(D.jsxs)(z.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(D.jsx)(V.a,{align:"center",sx:{maxWidth:40},children:(a=e.user_id,Object(D.jsx)(u.a,{display:"flex",minHeight:40,justifyContent:"center",alignContent:"center",children:n.get(a)&&Object(D.jsx)(M.a,{onClick:function(){return r(1)},children:Object(D.jsx)(Y,{status:"SUBMITTED",iconOnly:!0})})}))}),Object(D.jsx)(V.a,{children:e.learner_name}),Object(D.jsx)(V.a,{align:"center",children:t-e.tokens_used||0}),Object(D.jsx)(V.a,{align:"center",children:e.tokens_used})]},"".concat(c,"-").concat(e.user_id));var a})):Object(D.jsx)(z.a,{children:Object(D.jsx)(V.a,{colSpan:4,sx:{textAlign:"center"},children:Object(D.jsx)(h.a,{children:"No balances yet!"})})})})]})})},ee=n(234),te=n(57);var ne=function(e){var t=e.rows,n=e.openReviewDialog,c=Object(v.g)(Object(o.a)());return Object(D.jsx)(F.a,{component:H.a,children:Object(D.jsxs)(N.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(D.jsx)(J.a,{children:Object(D.jsxs)(z.a,{children:[Object(D.jsx)(V.a,{children:"Last Action"}),Object(D.jsx)(V.a,{children:"Student Name"}),Object(D.jsx)(V.a,{children:"Request"}),Object(D.jsx)(V.a,{children:"Status"}),Object(D.jsx)(V.a,{align:"center",children:"Action"})]})}),Object(D.jsx)(K.a,{children:t.length?t.map((function(e,t){return Object(D.jsxs)(z.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(D.jsx)(V.a,{sx:{borderLeft:"5px solid ".concat(c[e.status_name]," !important")},children:te.DateTime.fromFormat(e.updated_at,m.b).toLocaleString(te.DateTime.DATETIME_MED)}),Object(D.jsx)(V.a,{component:"th",scope:"row",children:e.learner_name}),Object(D.jsx)(V.a,{children:e.category_name}),Object(D.jsx)(V.a,{children:Object(D.jsx)(Y,{status:e.status_name})}),Object(D.jsx)(V.a,{align:"center",children:Object(D.jsx)(ee.a,{variant:"contained",onClick:function(){return n(e.request_id)},children:"Review"})})]},"".concat(t,"-").concat(e.request_id))})):Object(D.jsx)(z.a,{children:Object(D.jsx)(V.a,{colSpan:5,sx:{textAlign:"center"},children:Object(D.jsx)(h.a,{children:"No requests on record yet!"})})})})]})})};var ce=function(e){var t=e.rows,n=e.openReviewDialog;return Object(D.jsx)(F.a,{component:H.a,children:Object(D.jsxs)(N.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(D.jsx)(J.a,{children:Object(D.jsxs)(z.a,{children:[Object(D.jsx)(V.a,{children:"Student Name"}),Object(D.jsx)(V.a,{children:"Request"}),Object(D.jsx)(V.a,{children:"Description"}),Object(D.jsx)(V.a,{align:"center",children:"Action"})]})}),Object(D.jsx)(K.a,{children:t.length?t.map((function(e,t){return Object(D.jsxs)(z.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(D.jsx)(V.a,{component:"th",scope:"row",children:e.learner_name}),Object(D.jsx)(V.a,{children:e.category_name}),Object(D.jsx)(V.a,{sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.learner_comment}),Object(D.jsx)(V.a,{align:"center",children:Object(D.jsx)(ee.a,{variant:"contained",onClick:function(){return n(e.request_id)},children:"Review"})})]},"".concat(t,"-").concat(e.request_id))})):Object(D.jsx)(z.a,{children:Object(D.jsx)(V.a,{colSpan:4,sx:{textAlign:"center"},children:Object(D.jsx)(h.a,{children:"No pending requests!"})})})})]})})},re=n(247),ae=n(218),ie=n(249),se=n(250),oe=n(219),le=n(226),je=n(233),de=n(235),ue=n(252),be=n(230),he=n(253);var xe=function(e){var t=e.handleClose,n=e.handleSave,r=e.open,a=e.requestRow,i=Object(c.useState)(),o=Object(s.a)(i,2),l=o[0],j=o[1],d=Object(c.useState)(),b=Object(s.a)(d,2),x=b[0],O=b[1];return Object(c.useEffect)((function(){r&&(j(void 0),O(void 0))}),[r]),Object(D.jsx)(re.a,{open:r,onClose:t,children:a&&Object(D.jsx)(u.a,{p:2,children:Object(D.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),a&&l){var t={request_id:a.request_id,status_name:l};"REJECTED"===l&&(t.instructor_comment=x),n(t)}},children:[Object(D.jsx)(ae.a,{children:"Review Request"}),Object(D.jsxs)(ie.a,{children:[Object(D.jsx)(u.a,{mb:3,children:Object(D.jsx)(se.a,{children:"Review or take action on a token request."})}),Object(D.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(D.jsx)(u.a,{mr:2,children:Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Requester:"})})}),Object(D.jsx)(h.a,{children:a.learner_name})]}),Object(D.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(D.jsx)(u.a,{mr:2,children:Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Request Type:"})})}),Object(D.jsx)(h.a,{children:a.category_name})]}),Object(D.jsxs)(u.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(D.jsx)(u.a,{mb:2,children:Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Requester Comment:"})})}),Object(D.jsx)(u.a,{pl:2,children:Object(D.jsx)(le.a,{disabled:!0,fullWidth:!0,"aria-label":"Description of request as made by the requester",value:a.learner_comment||"",multiline:!0,minRows:1,maxRows:6})})]}),"SUBMITTED"===a.status_name?Object(D.jsxs)(u.a,{children:[Object(D.jsxs)(je.a,{children:[Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Instructor Action:"})}),Object(D.jsx)(u.a,{pl:2,children:Object(D.jsxs)(de.a,{id:"instructor-action",name:"instructor-action","aria-labelledby":"instructor-action",onChange:function(e){var t=e.target.value;"ACCEPTED"===t&&O(""),j(t)},children:[Object(D.jsx)(ue.a,{value:"ACCEPTED",control:Object(D.jsx)(be.a,{required:!0}),label:"Accept"}),Object(D.jsx)(ue.a,{value:"REJECTED",control:Object(D.jsx)(be.a,{required:!0}),label:"Reject"})]})})]}),"REJECTED"===l&&Object(D.jsxs)(u.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(D.jsx)(u.a,{mb:2,children:Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Instructor Comment:"})})}),Object(D.jsx)(u.a,{pl:2,children:Object(D.jsx)(le.a,{fullWidth:!0,required:!0,"aria-label":"An input for the instructor to comment on the request",multiline:!0,rows:6,value:x,onChange:function(e){var t=e.target.value;O(t)}})})]})]}):Object(D.jsxs)(u.a,{children:[Object(D.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(D.jsx)(u.a,{mr:2,children:Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Instructor Action:"})})}),Object(D.jsx)(Y,{status:a.status_name})]}),"REJECTED"===a.status_name&&Object(D.jsxs)(u.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(D.jsx)(u.a,{mb:2,children:Object(D.jsx)(oe.a,{children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Instructor Comment:"})})}),Object(D.jsx)(u.a,{pl:2,children:Object(D.jsx)(le.a,{disabled:!0,fullWidth:!0,"aria-label":"A comment on the request made by the instructor",value:a.instructor_comment||"",multiline:!0,minRows:1,maxRows:6})})]})]})]}),Object(D.jsxs)(he.a,{children:[Object(D.jsx)(ee.a,{onClick:t,variant:"outlined",children:"SUBMITTED"===a.status_name?"Cancel":"Close"}),"SUBMITTED"===a.status_name&&Object(D.jsx)(ee.a,{variant:"contained",type:"submit",children:"Save"})]})]})})})},Oe=n(220),pe=n(221),fe=n(251),me=n(232),ve=n(88);var ge=function(e){var t=e.handleClose,n=e.handleSave,r=e.open,a=e.settings,i=Object(ve.b)({defaultValues:{categories:[{category_name:"Missed Class",token_cost:1},{category_name:"Late Assignment",token_cost:1}]}}),s=i.control,o=i.register,l=i.handleSubmit,j=i.setValue,d=i.formState.errors,b=Object(ve.a)({control:s,name:"categories"}),x=b.fields,O=b.append,p=b.update,f=b.remove;return Object(c.useEffect)((function(){if(a&&r){var e=te.DateTime.fromFormat(a.use_by_date,m.b).toISODate();j("configuration_id",a.configuration_id),j("initial_tokens",a.initial_tokens),j("notifications_pref",a.notifications_pref),j("use_by_date",e),j("categories",a.categories)}}),[a,r,j]),Object(D.jsx)(re.a,{open:r,onClose:t,children:Object(D.jsx)(u.a,{p:2,children:Object(D.jsxs)("form",{onSubmit:l((function(e){var t={configuration_id:null===a||void 0===a?void 0:a.configuration_id,initial_tokens:"number"===typeof e.initial_tokens?e.initial_tokens:parseInt(e.initial_tokens),use_by_date:e.use_by_date,notifications_pref:e.notifications_pref,categories:e.categories};t.categories.forEach((function(e){e.category_id&&!e.dbAction?e.dbAction="UPDATE":e.category_id||e.dbAction||(e.dbAction="ADD")})),n(t)})),children:[Object(D.jsx)(ae.a,{children:"Instructor Settings"}),Object(D.jsxs)(ie.a,{children:[a&&Object(D.jsx)(u.a,{mb:3,children:Object(D.jsx)(se.a,{children:"View or update the settings for your token economy."})}),Object(D.jsxs)(u.a,{display:"flex",mt:1,mb:2,children:[Object(D.jsx)(u.a,{minWidth:300,width:300,mr:2,mt:1,children:Object(D.jsx)(fe.a,{htmlFor:"token-count",sx:{whiteSpace:"normal"},children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Amount of tokens to be available for each student:"})})}),Object(D.jsx)(u.a,{minWidth:150,width:150,children:Object(D.jsx)(le.a,Object(A.a)(Object(A.a)({autoFocus:!0,margin:"dense",size:"small",id:"token-count",type:"number",error:!!d.initial_tokens,InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{textAlign:"center"}}}},o("initial_tokens",{required:!0,pattern:/^[0-9]+$/,min:1})),{},{helperText:d.initial_tokens&&"Must be a positive whole number"}))})]}),Object(D.jsxs)(u.a,{display:"flex",mb:2,children:[Object(D.jsx)(u.a,{minWidth:300,mr:2,mt:2,children:Object(D.jsx)(fe.a,{htmlFor:"use-by-date",children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Date that tokens must be used by:"})})}),Object(D.jsx)(u.a,{children:Object(D.jsx)(le.a,Object(A.a)(Object(A.a)({margin:"dense",size:"small",id:"use-by-date",type:"date",error:!!d.use_by_date,InputLabelProps:{shrink:!1}},o("use_by_date",{required:!0})),{},{helperText:d.use_by_date&&"Must be a valid date"}))})]}),Object(D.jsxs)(u.a,{mb:2,children:[Object(D.jsxs)(u.a,{display:"flex",justifyContent:"start",alignItems:"center",children:[Object(D.jsx)(u.a,{mr:3,children:Object(D.jsx)(fe.a,{htmlFor:"email-pref",children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Email notifications:"})})}),Object(D.jsx)(me.a,Object(A.a)({defaultChecked:!0,inputProps:{"aria-label":"Email notifications preference checkbox"}},o("notifications_pref")))]}),Object(D.jsx)(u.a,{mb:3,children:Object(D.jsx)(h.a,{variant:"body2",children:"Receive emails when students use tokens."})})]}),Object(D.jsxs)(u.a,{display:"flex",flexDirection:"column",children:[Object(D.jsxs)(u.a,{display:"flex",children:[Object(D.jsx)(u.a,{minWidth:300,mr:2,children:Object(D.jsx)(fe.a,{htmlFor:"category-name-input-0",children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Categories:"})})}),Object(D.jsxs)(u.a,{minWidth:150,width:150,display:"flex",alignItems:"center",children:[Object(D.jsx)(W.a,{title:"The amount of tokens a student would need to spend.",placement:"top",children:Object(D.jsx)(Oe.a,{sx:{mr:1},color:"primary",fontSize:"small"})}),Object(D.jsx)(fe.a,{htmlFor:"category-token-input-0",children:Object(D.jsx)(h.a,{fontWeight:"bold",children:"Token Cost:"})})]})]}),Object(D.jsx)(u.a,{display:"flex",flexDirection:"column",children:x.map((function(e,t){var n,c,r,a,i,s,l,j;return Object(D.jsx)(u.a,{children:"DELETE"!==e.dbAction&&Object(D.jsxs)(u.a,{display:"flex",children:[Object(D.jsx)(u.a,{minWidth:300,mr:2,children:Object(D.jsx)(le.a,Object(A.a)({margin:"dense",size:"small",id:"category-name-".concat(t),type:"text",placeholder:"Enter category name...",InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{minWidth:250}}},helperText:(null===(n=d.categories)||void 0===n||null===(c=n[t])||void 0===c?void 0:c.category_name)&&"A category name is required",error:!(null===(r=d.categories)||void 0===r||null===(a=r[t])||void 0===a||!a.category_name)},o("categories.".concat(t,".category_name"),{required:!0})))}),Object(D.jsxs)(u.a,{display:"flex",alignItems:"start",minWidth:200,children:[Object(D.jsx)(u.a,{minWidth:150,width:150,children:Object(D.jsx)(le.a,Object(A.a)({margin:"dense",size:"small",id:"category-token-".concat(t),type:"number",InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{textAlign:"center"}}},error:!(null===(i=d.categories)||void 0===i||null===(s=i[t])||void 0===s||!s.token_cost),helperText:(null===(l=d.categories)||void 0===l||null===(j=l[t])||void 0===j?void 0:j.token_cost)&&"Must be a positive whole number"},o("categories.".concat(t,".token_cost"),{required:!0,pattern:/^[0-9]+$/,min:1})))}),Object(D.jsx)(u.a,{ml:1,mt:1,children:Object(D.jsx)(M.a,{disabled:x.filter((function(e){return"DELETE"!==e.dbAction})).length<=1,color:"primary",onClick:function(){var e;x[e=t].category_id?(x[e].dbAction="DELETE",p(e,Object(A.a)(Object(A.a)({},x[e]),{},{dbAction:"DELETE"}))):f(e)},children:Object(D.jsx)(G.a,{})})})]})]})},e.id)}))}),Object(D.jsx)(u.a,{mt:2,children:Object(D.jsx)(ee.a,{variant:"contained",startIcon:Object(D.jsx)(pe.a,{}),onClick:function(){O({})},children:"New Category"})})]})]}),Object(D.jsxs)(he.a,{children:[(null===a||void 0===a?void 0:a.configuration_id)&&Object(D.jsx)(ee.a,{onClick:t,variant:"outlined",children:"Cancel"}),Object(D.jsx)(ee.a,{variant:"contained",type:"submit",children:"Save"})]})]})})})},ye=n(46),_e=["children","value","index"];var Ee=function(e){var t=e.children,n=e.value,c=e.index,r=Object(ye.a)(e,_e);return Object(D.jsx)("div",Object(A.a)(Object(A.a)({role:"tabpanel",hidden:n!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},r),{},{children:n===c&&Object(D.jsx)(u.a,{sx:{p:3},children:t})}))};var ke=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(s.a)(a,2),o=i[0],l=i[1],j=Object(c.useState)(!1),d=Object(s.a)(j,2),b=d[0],h=d[1],p=Object(c.useState)(),f=Object(s.a)(p,2),m=f[0],g=f[1],y=Object(c.useState)(new Map),C=Object(s.a)(y,2),T=C[0],q=C[1],F=Object(c.useState)([]),H=Object(s.a)(F,2),N=H[0],J=H[1],z=Object(c.useState)([]),V=Object(s.a)(z,2),K=V[0],X=V[1],$=Object(c.useState)([]),G=Object(s.a)($,2),Q=G[0],Y=G[1],ee=Object(c.useState)(),te=Object(s.a)(ee,2),re=te[0],ae=te[1];Object(c.useEffect)((function(){ie()}),[]),Object(c.useEffect)((function(){var e=new Map;K.forEach((function(t){e.set(t.user_id,!0)})),q(e)}),[K]),Object(c.useEffect)((function(){T.size&&S().then((function(e){var t=Object(v.h)(e,T);J(t)}))}),[T]),Object(c.useEffect)((function(){null===m&&h(!0)}),[m]);var ie=function(){var e=Object(O.a)(Object(x.a)().mark((function e(){var t,n,c;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,g(t),e.next=6,w();case 6:n=e.sent,(c=n.filter((function(e){return"SUBMITTED"===e.status_name}))).sort(v.c),X(c),n.sort(v.b),Y(n);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(O.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.configuration_id){e.next=5;break}return e.next=3,k(t);case 3:e.next=7;break;case 5:return e.next=7,E(t);case 7:return h(!1),e.next=10,_();case 10:n=e.sent,g(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(O.a)(Object(x.a)().mark((function e(t){return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!1),e.next=3,I(t);case 3:return e.next=5,ie();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[m&&Object(D.jsxs)(u.a,{children:[Object(D.jsxs)(u.a,{display:"flex",justifyContent:"end",mr:1,mb:2,children:[Object(D.jsx)(W.a,{title:"There are pending requests requiring review",children:Object(D.jsx)(M.a,{onClick:function(){return r(1)},children:Object(D.jsx)(U.a,{badgeContent:K.length,color:"primary",children:Object(D.jsx)(P.a,{})})})}),Object(D.jsx)(W.a,{title:"Review or update Tokens settings",children:Object(D.jsx)(M.a,{onClick:function(){h(!0)},children:Object(D.jsx)(R.a,{})})})]}),Object(D.jsx)(u.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(D.jsxs)(L.a,{value:n,onChange:function(e,t){r(t)},"aria-label":"basic tabs example",children:[Object(D.jsx)(B.a,Object(A.a)({label:"Balances"},Object(v.a)(0))),Object(D.jsx)(B.a,Object(A.a)({label:"Requests"},Object(v.a)(1))),Object(D.jsx)(B.a,Object(A.a)({label:"History"},Object(v.a)(2)))]})}),Object(D.jsx)(Ee,{value:n,index:0,children:Object(D.jsx)(Z,{rows:N,requestMap:T,initialTokens:(null===m||void 0===m?void 0:m.initial_tokens)||0,setTabPosition:r})}),Object(D.jsx)(Ee,{value:n,index:1,children:Object(D.jsx)(ce,{rows:K,openReviewDialog:function(e){ae(K.find((function(t){return t.request_id===e}))),l(!0)}})}),Object(D.jsx)(Ee,{value:n,index:2,children:Object(D.jsx)(ne,{rows:Q,openReviewDialog:function(e){ae(Q.find((function(t){return t.request_id===e}))),l(!0)}})})]}),Object(D.jsx)(ge,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||h(!1)},handleSave:se,open:b,settings:m||null}),Object(D.jsx)(xe,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||l(!1)},handleSave:oe,open:o,requestRow:re||null})]})};var Se=function(){var e=Object(c.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){console.info("Running in cra environment: ".concat(Object(v.e)())),y().then((function(e){if(e&&"string"!==typeof e){console.info("Application configuration information retrieved");var t=Object(v.d)(e);r(t)}else console.error("Unable to retrieve App Info - Session may be expired")}))}),[]);var a=Object(o.a)().palette.primary.main,i=Object(l.a)({palette:{primary:{main:(null===n||void 0===n?void 0:n.baseColor)||a},mode:null!==n&&void 0!==n&&n.darkMode?"dark":"light"},components:{MuiTableCell:{styleOverrides:{head:{fontWeight:"bold"}}}}});return Object(D.jsxs)(j.a,{theme:i,children:[Object(D.jsx)(d.a,{}),Object(D.jsx)("div",{className:"App",children:n&&Object(D.jsx)(q.Provider,{value:n,children:Object(D.jsx)(u.a,{display:"flex",className:"App-header",children:Object(D.jsxs)(u.a,{width:"100%",p:4,height:"100vh",display:"flex",flexDirection:"column",children:[Object(D.jsx)(T,{}),Object(D.jsx)(u.a,{children:Object(D.jsx)(ke,{})})]})})})}),"pre_build"===Object(v.e)()&&Object(D.jsx)(C,{})]})},we=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,255)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.createRoot(document.getElementById("root")).render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(Se,{})})),we()},20:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"a",(function(){return b}));var c=n(10),r=n(34),a=function(e){var t=i(),n={};return"pre_build"===t&&(n=r.a),Object(c.a)(Object(c.a)(Object(c.a)({},e),r.c[t]),n)},i=function(){var t;return(null===(t=e)||void 0===t?void 0:"deployed_build")||"production"},s=function(){var e=window.appConfig||null;return(null===e||void 0===e?void 0:e.sessionId)||""},o=function(e){return{SUBMITTED:e.palette.warning.main,ACCEPTED:e.palette.success.main,REJECTED:e.palette.error.main}},l=function(e,t){return e<t?-1:e>t?1:0},j=function(e,t){var n=e.learner_name.split(" "),c=t.learner_name.split(" "),r=n[n.length-1],a=c[c.length-1];return r===a?l(n[0],c[0]):l(r,a)},d=function(e,t){return new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()},u=function(e,t){e.sort(j);var n=[],c=[];return e.forEach((function(e){t.get(e.user_id)?n.push(e):c.push(e)})),[].concat(n,c)};function b(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}}).call(this,n(81))},34:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s}));var c=n(20),r={sessionId:"397e599274b27184c9c5c9b96cd18d58",baseColor:"#6B5B95"},a=Object(c.f)(),i={pre_build:{apiUrl:"/learning-apps/mod/mod-tokens/api/index.php",sessionId:r.sessionId||""},local_build:{apiUrl:"/learning-apps/mod/mod-tokens/api/index.php",sessionId:a},deployed_build:{apiUrl:"/tsugi/mod/mod-tokens/api/index.php",sessionId:a}},s="yyyy-MM-dd HH:mm:ss"}},[[167,1,2]]]);
//# sourceMappingURL=main.67191880.chunk.js.map