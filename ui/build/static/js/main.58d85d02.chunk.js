(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{139:function(e,t,n){},140:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(106),i=n.n(a),s=(n(139),n(12)),o=n(27),l=n(111),j=n(238),d=n(226),u=n(239),b=(n(140),n(240)),h=n(177),O=n(15),x=n(20),p=n(41),f=n.n(p),m=n(39),v=n(19),g=m.c[Object(v.e)()],y=function(){var e=Object(x.a)(Object(O.a)().mark((function e(){var t;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/info?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(x.a)(Object(O.a)().mark((function e(){var t;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(x.a)(Object(O.a)().mark((function e(t){var n;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,e.next=4,f.a.post("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId),n);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(x.a)(Object(O.a)().mark((function e(t){var n;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,e.next=4,f.a.put("".concat(g.apiUrl,"/instructor/settings?PHPSESSID=").concat(g.sessionId),n);case 4:return e.abrupt("return");case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(x.a)(Object(O.a)().mark((function e(){var t;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/instructor/balances?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(x.a)(Object(O.a)().mark((function e(){var t;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("".concat(g.apiUrl,"/instructor/requests?PHPSESSID=").concat(g.sessionId));case 3:return t=e.sent,e.abrupt("return",t.data.data||[]);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(x.a)(Object(O.a)().mark((function e(t){var n;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("UPDATING request"),e.prev=1,n=t,e.next=5,f.a.put("".concat(g.apiUrl,"/instructor/requests?PHPSESSID=").concat(g.sessionId),n);case 5:return e.abrupt("return");case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),I=n(0);var C=function(e){var t=Object(c.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(),o=Object(s.a)(i,2),l=o[0],j=o[1];return Object(c.useEffect)((function(){y().then((function(e){!e||"string"===typeof e&&e.includes("Session expired")?(console.error("SESSION EXPIRED"),a(!0)):(j(e),a(!1))}))}),[]),Object(I.jsx)(u.a,{position:"absolute",bottom:0,p:2,children:Object(I.jsx)(b.a,{sx:{border:"2px solid red"},children:Object(I.jsxs)(u.a,{p:2,textAlign:"center",children:[Object(I.jsxs)(h.a,{children:["React App status is: ",Object(v.e)()]}),Object(I.jsxs)(h.a,{children:["Session ID is: ",null===l||void 0===l?void 0:l.sessionId]}),"Session is: ",r?"EXPIRED":"VALID"]})})})};var T=function(e){return Object(I.jsx)(u.a,{mt:6,children:Object(I.jsx)(h.a,{variant:"h3",children:"Tokens"})})},A=Object(c.createContext)({apiUrl:"",contextId:"",isInstructor:!1,linkId:"",sessionId:"",username:"",darkMode:!1,baseColor:""}),q=n(10),R=n(224),P=n(225),W=n(227),M=n(242),U=n(233),L=n(230),B=n(256),F=n(243),H=n(241),N=n(244),z=n(245),J=n(246),V=n(247),K=n(248),X=n(210),$=n(211),G=n(212),Q={SUBMITTED:{icon:Object(I.jsx)(X.a,{color:"warning"}),text:"Pending",tooltip:"Request has not yet been accepted or rejected"},ACCEPTED:{icon:Object(I.jsx)($.a,{color:"success"}),text:"Accepted",tooltip:"Request has been accepted"},REJECTED:{icon:Object(I.jsx)(G.a,{color:"error"}),text:"Rejected",tooltip:"Request has been rejected"}};var Y=function(e){var t=e.status,n=e.iconOnly;return Object(I.jsxs)(u.a,{display:"flex",alignItems:"center",children:[Object(I.jsx)(u.a,{display:"flex",alignItems:"center",children:Object(I.jsx)(W.a,{title:Q[t].tooltip,children:Q[t].icon})}),!n&&Object(I.jsx)(h.a,{sx:{ml:1},children:Q[t].text})]})};var Z=function(e){var t=e.initialTokens,n=e.requestMap,c=e.rows,r=e.setTabPosition;return Object(I.jsx)(F.a,{component:H.a,children:Object(I.jsxs)(N.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(I.jsx)(z.a,{children:Object(I.jsxs)(J.a,{children:[Object(I.jsx)(V.a,{}),Object(I.jsx)(V.a,{children:"Student Name"}),Object(I.jsx)(V.a,{align:"center",children:"Balance Remaining"}),Object(I.jsx)(V.a,{align:"center",children:"Tokens Used"})]})}),Object(I.jsx)(K.a,{children:c.length?c.map((function(e,c){return Object(I.jsxs)(J.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(I.jsx)(V.a,{align:"center",sx:{maxWidth:40},children:(a=e.user_id,Object(I.jsx)(u.a,{display:"flex",minHeight:40,justifyContent:"center",alignContent:"center",children:n.get(a)&&Object(I.jsx)(M.a,{onClick:function(){return r(1)},children:Object(I.jsx)(Y,{status:"SUBMITTED",iconOnly:!0})})}))}),Object(I.jsx)(V.a,{children:e.learner_name}),Object(I.jsx)(V.a,{align:"center",children:t-e.tokens_used||0}),Object(I.jsx)(V.a,{align:"center",children:e.tokens_used})]},"".concat(c,"-").concat(e.user_id));var a})):Object(I.jsx)(J.a,{children:Object(I.jsx)(V.a,{colSpan:4,sx:{textAlign:"center"},children:Object(I.jsx)(h.a,{children:"No balances yet!"})})})})]})})},ee=n(236);var te=function(e){var t=e.rows,n=e.openReviewDialog,c=Object(v.g)(Object(o.a)());return Object(I.jsx)(F.a,{component:H.a,children:Object(I.jsxs)(N.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(I.jsx)(z.a,{children:Object(I.jsxs)(J.a,{children:[Object(I.jsx)(V.a,{children:"Last Action"}),Object(I.jsx)(V.a,{children:"Student Name"}),Object(I.jsx)(V.a,{children:"Request"}),Object(I.jsx)(V.a,{children:"Status"}),Object(I.jsx)(V.a,{align:"center",children:"Action"})]})}),Object(I.jsx)(K.a,{children:t.length?t.map((function(e,t){return Object(I.jsxs)(J.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(I.jsx)(V.a,{sx:{borderLeft:"5px solid ".concat(c[e.status_name]," !important")},children:Object(v.c)(e.updated_at)}),Object(I.jsx)(V.a,{component:"th",scope:"row",children:e.learner_name}),Object(I.jsx)(V.a,{children:e.category_name}),Object(I.jsx)(V.a,{children:Object(I.jsx)(Y,{status:e.status_name})}),Object(I.jsx)(V.a,{align:"center",children:Object(I.jsx)(ee.a,{variant:"contained",onClick:function(){return n(e.request_id)},children:"Review"})})]},"".concat(t,"-").concat(e.request_id))})):Object(I.jsx)(J.a,{children:Object(I.jsx)(V.a,{colSpan:5,sx:{textAlign:"center"},children:Object(I.jsx)(h.a,{children:"No requests on record yet!"})})})})]})})};var ne=function(e){var t=e.rows,n=e.openReviewDialog;return Object(I.jsx)(F.a,{component:H.a,children:Object(I.jsxs)(N.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(I.jsx)(z.a,{children:Object(I.jsxs)(J.a,{children:[Object(I.jsx)(V.a,{children:"Request Date"}),Object(I.jsx)(V.a,{children:"Student Name"}),Object(I.jsx)(V.a,{children:"Request"}),Object(I.jsx)(V.a,{children:"Description"}),Object(I.jsx)(V.a,{align:"center",children:"Action"})]})}),Object(I.jsx)(K.a,{children:t.length?t.map((function(e,t){return Object(I.jsxs)(J.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(I.jsx)(V.a,{children:Object(v.c)(e.created_at)}),Object(I.jsx)(V.a,{children:e.learner_name}),Object(I.jsx)(V.a,{children:e.category_name}),Object(I.jsx)(V.a,{sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.learner_comment}),Object(I.jsx)(V.a,{align:"center",children:Object(I.jsx)(ee.a,{variant:"contained",onClick:function(){return n(e.request_id)},children:"Review"})})]},"".concat(t,"-").concat(e.request_id))})):Object(I.jsx)(J.a,{children:Object(I.jsx)(V.a,{colSpan:4,sx:{textAlign:"center"},children:Object(I.jsx)(h.a,{children:"No pending requests!"})})})})]})})},ce=n(249),re=n(218),ae=n(251),ie=n(252),se=n(219),oe=n(228),le=n(235),je=n(237),de=n(254),ue=n(232),be=n(255);var he=function(e){var t=e.handleClose,n=e.handleSave,r=e.open,a=e.requestRow,i=Object(c.useState)(),o=Object(s.a)(i,2),l=o[0],j=o[1],d=Object(c.useState)(),b=Object(s.a)(d,2),O=b[0],x=b[1];return Object(c.useEffect)((function(){r&&(j(void 0),x(void 0))}),[r]),Object(I.jsx)(ce.a,{open:r,onClose:t,children:a&&Object(I.jsx)(u.a,{p:2,children:Object(I.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),a&&l){var t={request_id:a.request_id,status_name:l};"REJECTED"===l&&(t.instructor_comment=O),n(t)}},children:[Object(I.jsx)(re.a,{children:"Review Request"}),Object(I.jsxs)(ae.a,{children:[Object(I.jsx)(u.a,{mb:3,children:Object(I.jsx)(ie.a,{children:"Review or take action on a token request."})}),Object(I.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(I.jsx)(u.a,{mr:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Date:"})})}),Object(I.jsx)(h.a,{children:Object(v.c)(a.created_at)})]}),Object(I.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(I.jsx)(u.a,{mr:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Requester:"})})}),Object(I.jsx)(h.a,{children:a.learner_name})]}),Object(I.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(I.jsx)(u.a,{mr:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Type:"})})}),Object(I.jsxs)(h.a,{children:[a.category_name," (",a.token_cost," token",a.token_cost>1&&"s",")"]})]}),Object(I.jsxs)(u.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(I.jsx)(u.a,{mb:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Requester Description:"})})}),Object(I.jsx)(u.a,{pl:2,children:Object(I.jsx)(oe.a,{disabled:!0,fullWidth:!0,"aria-label":"Description of request as made by the requester",value:a.learner_comment||"",multiline:!0,minRows:1,maxRows:6})})]}),"SUBMITTED"===a.status_name?Object(I.jsxs)(u.a,{children:[Object(I.jsxs)(le.a,{children:[Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Instructor Action:"})}),Object(I.jsx)(u.a,{pl:2,children:Object(I.jsxs)(je.a,{id:"instructor-action",name:"instructor-action","aria-labelledby":"instructor-action",onChange:function(e){var t=e.target.value;"ACCEPTED"===t&&x(""),j(t)},children:[Object(I.jsx)(de.a,{value:"ACCEPTED",control:Object(I.jsx)(ue.a,{required:!0}),label:"Accept"}),Object(I.jsx)(de.a,{value:"REJECTED",control:Object(I.jsx)(ue.a,{required:!0}),label:"Reject"})]})})]}),"REJECTED"===l&&Object(I.jsxs)(u.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(I.jsx)(u.a,{mb:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Instructor Comment:"})})}),Object(I.jsx)(u.a,{pl:2,children:Object(I.jsx)(oe.a,{fullWidth:!0,required:!0,"aria-label":"An input for the instructor to comment on the request",multiline:!0,rows:6,value:O,onChange:function(e){var t=e.target.value;x(t)}})})]})]}):Object(I.jsxs)(u.a,{children:[Object(I.jsxs)(u.a,{display:"flex",mt:1,mb:2,alignItems:"center",children:[Object(I.jsx)(u.a,{mr:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Instructor Action:"})})}),Object(I.jsx)(Y,{status:a.status_name})]}),"REJECTED"===a.status_name&&Object(I.jsxs)(u.a,{display:"flex",flexDirection:"column",mt:1,mb:2,children:[Object(I.jsx)(u.a,{mb:2,children:Object(I.jsx)(se.a,{children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Instructor Comment:"})})}),Object(I.jsx)(u.a,{pl:2,children:Object(I.jsx)(oe.a,{disabled:!0,fullWidth:!0,"aria-label":"A comment on the request made by the instructor",value:a.instructor_comment||"",multiline:!0,minRows:1,maxRows:6})})]})]})]}),Object(I.jsxs)(be.a,{children:[Object(I.jsx)(ee.a,{onClick:t,variant:"outlined",children:"SUBMITTED"===a.status_name?"Cancel":"Close"}),"SUBMITTED"===a.status_name&&Object(I.jsx)(ee.a,{variant:"contained",type:"submit",children:"Save"})]})]})})})},Oe=n(220),xe=n(221),pe=n(222),fe=n(223),me=n(253),ve=n(234),ge=n(57),ye=n(88);var _e=function(e){var t=e.handleClose,n=e.handleSave,r=e.open,a=e.settings,i=Object(ye.b)({defaultValues:{categories:[{category_name:"Missed Class",token_cost:1,dbAction:"ADD",sort_order:0},{category_name:"Late Assignment",token_cost:1,dbAction:"ADD",sort_order:1}]}}),s=i.control,o=i.register,l=i.handleSubmit,j=i.setValue,d=i.formState.errors,b=Object(ye.a)({control:s,name:"categories"}),O=b.fields,x=b.append,p=b.move,f=b.update,v=b.remove,g=Object(c.useCallback)((function(e){var t=ge.DateTime.fromFormat(e.use_by_date,m.b).toISODate();j("configuration_id",e.configuration_id),j("initial_tokens",e.initial_tokens),j("notifications_pref",e.notifications_pref),j("use_by_date",t),j("categories",e.categories)}),[j]);return Object(c.useEffect)((function(){a&&r&&g(a)}),[a,r,g]),Object(I.jsx)(ce.a,{open:r,onClose:t,children:Object(I.jsx)(u.a,{p:2,children:Object(I.jsxs)("form",{onSubmit:l((function(e){var t={configuration_id:null===a||void 0===a?void 0:a.configuration_id,initial_tokens:"number"===typeof e.initial_tokens?e.initial_tokens:parseInt(e.initial_tokens),use_by_date:e.use_by_date,notifications_pref:e.notifications_pref,categories:e.categories};t.categories.forEach((function(e,t){e.sort_order=t,e.category_id&&!e.dbAction?e.dbAction="UPDATE":e.category_id||e.dbAction||(e.dbAction="ADD")})),n(t)})),children:[Object(I.jsx)(re.a,{children:"Instructor Settings"}),Object(I.jsxs)(ae.a,{children:[a&&Object(I.jsx)(u.a,{mb:3,children:Object(I.jsx)(ie.a,{children:"View or update the settings for your token economy."})}),Object(I.jsxs)(u.a,{display:"flex",mt:1,mb:2,children:[Object(I.jsx)(u.a,{minWidth:300,width:300,mr:2,mt:1,children:Object(I.jsx)(me.a,{htmlFor:"token-count",sx:{whiteSpace:"normal"},children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Amount of tokens to be available for each student:"})})}),Object(I.jsx)(u.a,{minWidth:150,width:150,children:Object(I.jsx)(oe.a,Object(q.a)(Object(q.a)({autoFocus:!0,margin:"dense",size:"small",id:"token-count",type:"number",error:!!d.initial_tokens,InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{textAlign:"center"}}}},o("initial_tokens",{required:!0,pattern:/^[0-9]+$/,min:1})),{},{helperText:d.initial_tokens&&"Must be a positive whole number"}))})]}),Object(I.jsxs)(u.a,{display:"flex",mb:2,children:[Object(I.jsx)(u.a,{minWidth:300,mr:2,mt:2,children:Object(I.jsx)(me.a,{htmlFor:"use-by-date",children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Date that tokens must be used by:"})})}),Object(I.jsx)(u.a,{children:Object(I.jsx)(oe.a,Object(q.a)(Object(q.a)({margin:"dense",size:"small",id:"use-by-date",type:"date",error:!!d.use_by_date,InputLabelProps:{shrink:!1}},o("use_by_date",{required:!0})),{},{helperText:d.use_by_date&&"Must be a valid date"}))})]}),Object(I.jsxs)(u.a,{mb:2,children:[Object(I.jsxs)(u.a,{display:"flex",justifyContent:"start",alignItems:"center",children:[Object(I.jsx)(u.a,{mr:3,children:Object(I.jsx)(me.a,{htmlFor:"email-pref",children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Email notifications:"})})}),Object(I.jsx)(ve.a,Object(q.a)({defaultChecked:!0,inputProps:{"aria-label":"Email notifications preference checkbox"}},o("notifications_pref")))]}),Object(I.jsx)(u.a,{mb:3,children:Object(I.jsx)(h.a,{variant:"body2",children:"Receive emails when students use tokens."})})]}),Object(I.jsxs)(u.a,{display:"flex",flexDirection:"column",children:[Object(I.jsxs)(u.a,{display:"flex",children:[Object(I.jsx)(u.a,{minWidth:300,mr:2,children:Object(I.jsx)(me.a,{htmlFor:"category-name-input-0",children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Categories:"})})}),Object(I.jsxs)(u.a,{minWidth:150,width:150,display:"flex",alignItems:"center",children:[Object(I.jsx)(W.a,{title:"The amount of tokens a student would need to spend.",placement:"top",children:Object(I.jsx)(Oe.a,{sx:{mr:1},color:"primary",fontSize:"small"})}),Object(I.jsx)(me.a,{htmlFor:"category-token-input-0",children:Object(I.jsx)(h.a,{fontWeight:"bold",children:"Token Cost:"})})]})]}),Object(I.jsx)(u.a,{display:"flex",flexDirection:"column",children:O.map((function(e,t){var n,c,r,a,i,s,l,j;return Object(I.jsx)(u.a,{children:"DELETE"!==e.dbAction&&Object(I.jsxs)(u.a,{display:"flex",children:[Object(I.jsxs)(u.a,{children:[Object(I.jsx)(M.a,{size:"small",disabled:0===t,disableRipple:!0,onClick:function(){return function(e){p(e,e-1)}(t)},children:Object(I.jsx)(xe.a,{fontSize:"small"})}),Object(I.jsx)(M.a,{size:"small",disabled:t===O.length-1,disableRipple:!0,onClick:function(){return function(e){p(e,e+1)}(t)},children:Object(I.jsx)(pe.a,{fontSize:"small"})})]}),Object(I.jsx)(u.a,{minWidth:300,mr:2,children:Object(I.jsx)(oe.a,Object(q.a)({margin:"dense",size:"small",id:"category-name-".concat(t),type:"text",placeholder:"Enter category name...",InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{minWidth:250}}},helperText:(null===(n=d.categories)||void 0===n||null===(c=n[t])||void 0===c?void 0:c.category_name)&&"A category name is required",error:!(null===(r=d.categories)||void 0===r||null===(a=r[t])||void 0===a||!a.category_name)},o("categories.".concat(t,".category_name"),{required:!0})))}),Object(I.jsxs)(u.a,{display:"flex",alignItems:"start",minWidth:200,children:[Object(I.jsx)(u.a,{minWidth:150,width:150,children:Object(I.jsx)(oe.a,Object(q.a)({margin:"dense",size:"small",id:"category-token-".concat(t),type:"number",InputLabelProps:{shrink:!1},InputProps:{inputProps:{style:{textAlign:"center"}}},error:!(null===(i=d.categories)||void 0===i||null===(s=i[t])||void 0===s||!s.token_cost),helperText:(null===(l=d.categories)||void 0===l||null===(j=l[t])||void 0===j?void 0:j.token_cost)&&"Must be a positive whole number"},o("categories.".concat(t,".token_cost"),{required:!0,pattern:/^[0-9]+$/,min:1})))}),Object(I.jsx)(u.a,{ml:1,mt:1,children:Object(I.jsx)(W.a,{title:e.is_used?"Category is associated with a request and cannot be deleted":"",children:Object(I.jsx)("div",{children:Object(I.jsx)(M.a,{disabled:e.is_used||O.filter((function(e){return"DELETE"!==e.dbAction})).length<=1,color:"primary",onClick:function(){var e;O[e=t].category_id?(O[e].dbAction="DELETE",f(e,Object(q.a)(Object(q.a)({},O[e]),{},{dbAction:"DELETE"}))):v(e)},children:Object(I.jsx)(G.a,{})})})})})]})]})},e.id)}))}),Object(I.jsx)(u.a,{mt:2,children:Object(I.jsx)(ee.a,{variant:"contained",startIcon:Object(I.jsx)(fe.a,{}),onClick:function(){x({sort_order:O.length})},children:"New Category"})})]})]}),Object(I.jsxs)(be.a,{children:[(null===a||void 0===a?void 0:a.configuration_id)&&Object(I.jsx)(ee.a,{onClick:t,variant:"outlined",children:"Cancel"}),Object(I.jsx)(ee.a,{variant:"contained",type:"submit",children:"Save"})]})]})})})},ke=n(47),Ee=["children","value","index"];var Se=function(e){var t=e.children,n=e.value,c=e.index,r=Object(ke.a)(e,Ee);return Object(I.jsx)("div",Object(q.a)(Object(q.a)({role:"tabpanel",hidden:n!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},r),{},{children:n===c&&Object(I.jsx)(u.a,{sx:{p:3},children:t})}))};var we=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(s.a)(a,2),o=i[0],l=i[1],j=Object(c.useState)(!1),d=Object(s.a)(j,2),b=d[0],h=d[1],p=Object(c.useState)(),f=Object(s.a)(p,2),m=f[0],g=f[1],y=Object(c.useState)(new Map),C=Object(s.a)(y,2),T=C[0],A=C[1],F=Object(c.useState)([]),H=Object(s.a)(F,2),N=H[0],z=H[1],J=Object(c.useState)([]),V=Object(s.a)(J,2),K=V[0],X=V[1],$=Object(c.useState)([]),G=Object(s.a)($,2),Q=G[0],Y=G[1],ee=Object(c.useState)(),ce=Object(s.a)(ee,2),re=ce[0],ae=ce[1];Object(c.useEffect)((function(){ie()}),[]),Object(c.useEffect)((function(){var e=new Map;K.forEach((function(t){e.set(t.user_id,!0)})),A(e)}),[K]),Object(c.useEffect)((function(){T.size&&S().then((function(e){var t=Object(v.h)(e,T);z(t)}))}),[T]),Object(c.useEffect)((function(){null===m&&h(!0)}),[m]);var ie=function(){var e=Object(x.a)(Object(O.a)().mark((function e(){var t,n,c;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,g(t),e.next=6,w();case 6:(n=e.sent).sort(v.b),c=n.filter((function(e){return"SUBMITTED"===e.status_name})),X(c),Y(n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=Object(x.a)(Object(O.a)().mark((function e(t){var n;return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.configuration_id){e.next=5;break}return e.next=3,E(t);case 3:e.next=7;break;case 5:return e.next=7,k(t);case 7:return h(!1),e.next=10,_();case 10:n=e.sent,g(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(x.a)(Object(O.a)().mark((function e(t){return Object(O.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!1),e.next=3,D(t);case 3:return e.next=5,ie();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsxs)(I.Fragment,{children:[m&&Object(I.jsxs)(u.a,{children:[Object(I.jsxs)(u.a,{display:"flex",justifyContent:"end",mr:1,mb:2,children:[Object(I.jsx)(W.a,{title:"There are pending requests requiring review",children:Object(I.jsx)(M.a,{onClick:function(){return r(1)},children:Object(I.jsx)(U.a,{badgeContent:K.length,color:"primary",children:Object(I.jsx)(R.a,{})})})}),Object(I.jsx)(W.a,{title:"Review or update Tokens settings",children:Object(I.jsx)(M.a,{onClick:function(){h(!0)},children:Object(I.jsx)(P.a,{})})})]}),Object(I.jsx)(u.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(I.jsxs)(L.a,{value:n,onChange:function(e,t){r(t)},"aria-label":"basic tabs example",children:[Object(I.jsx)(B.a,Object(q.a)({label:"Balances"},Object(v.a)(0))),Object(I.jsx)(B.a,Object(q.a)({label:"Requests"},Object(v.a)(1))),Object(I.jsx)(B.a,Object(q.a)({label:"History"},Object(v.a)(2)))]})}),Object(I.jsx)(Se,{value:n,index:0,children:Object(I.jsx)(Z,{rows:N,requestMap:T,initialTokens:(null===m||void 0===m?void 0:m.initial_tokens)||0,setTabPosition:r})}),Object(I.jsx)(Se,{value:n,index:1,children:Object(I.jsx)(ne,{rows:K,openReviewDialog:function(e){ae(K.find((function(t){return t.request_id===e}))),l(!0)}})}),Object(I.jsx)(Se,{value:n,index:2,children:Object(I.jsx)(te,{rows:Q,openReviewDialog:function(e){ae(Q.find((function(t){return t.request_id===e}))),l(!0)}})})]}),Object(I.jsx)(_e,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||h(!1)},handleSave:se,open:b,settings:m||null}),Object(I.jsx)(he,{handleClose:function(e,t){t&&["backdropClick","escapeKeyDown"].includes(t)||l(!1)},handleSave:oe,open:o,requestRow:re||null})]})};var De=function(){var e=Object(c.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){console.info("Running in cra environment: ".concat(Object(v.e)())),y().then((function(e){if(e&&"string"!==typeof e){console.info("Application configuration information retrieved");var t=Object(v.d)(e);r(t)}else console.error("Unable to retrieve App Info - Session may be expired")}))}),[]);var a=Object(o.a)().palette.primary.main,i=Object(l.a)({palette:{primary:{main:(null===n||void 0===n?void 0:n.baseColor)||a},mode:null!==n&&void 0!==n&&n.darkMode?"dark":"light"},components:{MuiTableCell:{styleOverrides:{head:{fontWeight:"bold"}}}}});return Object(I.jsxs)(j.a,{theme:i,children:[Object(I.jsx)(d.a,{}),Object(I.jsx)("div",{className:"App",children:n&&Object(I.jsx)(A.Provider,{value:n,children:Object(I.jsx)(u.a,{display:"flex",className:"App-header",children:Object(I.jsxs)(u.a,{width:"100%",p:4,height:"100vh",display:"flex",flexDirection:"column",children:[Object(I.jsx)(T,{}),Object(I.jsx)(u.a,{children:Object(I.jsx)(we,{})})]})})})}),"pre_build"===Object(v.e)()&&Object(I.jsx)(C,{})]})},Ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.createRoot(document.getElementById("root")).render(Object(I.jsx)(r.a.StrictMode,{children:Object(I.jsx)(De,{})})),Ie()},19:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return O}));var c=n(10),r=n(57),a=n(39),i=function(e){var t=s(),n={};return"pre_build"===t&&(n=a.a),Object(c.a)(Object(c.a)(Object(c.a)({},e),a.c[t]),n)},s=function(){var t;return(null===(t=e)||void 0===t?void 0:"deployed_build")||"production"},o=function(){var e=window.appConfig||null;return(null===e||void 0===e?void 0:e.sessionId)||""},l=function(e){return{SUBMITTED:e.palette.warning.main,ACCEPTED:e.palette.success.main,REJECTED:e.palette.error.main}},j=function(e,t){return e<t?-1:e>t?1:0},d=function(e,t){var n=e.learner_name.split(" "),c=t.learner_name.split(" "),r=n[n.length-1],a=c[c.length-1];return r===a?j(n[0],c[0]):j(r,a)},u=function(e,t){return new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime()},b=function(e,t){e.sort(d);var n=[],c=[];return e.forEach((function(e){t.get(e.user_id)?n.push(e):c.push(e)})),[].concat(n,c)};function h(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}function O(e,t){return r.DateTime.fromFormat(e,a.b).toLocaleString(r.DateTime.DATETIME_MED||t)}}).call(this,n(81))},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s}));var c=n(19),r={sessionId:"397e599274b27184c9c5c9b96cd18d58",baseColor:"#6B5B95"},a=Object(c.f)(),i={pre_build:{apiUrl:"/learning-apps/mod/mod-tokens/api/index.php",sessionId:r.sessionId||""},local_build:{apiUrl:"/learning-apps/mod/mod-tokens/api/index.php",sessionId:a},deployed_build:{apiUrl:"/mod/tokens/api/index.php",sessionId:a}},s="yyyy-MM-dd HH:mm:ss"}},[[167,1,2]]]);
//# sourceMappingURL=main.58d85d02.chunk.js.map